import io
import cv2
import dlib
import face_recognition
import base64
from PIL import Image
import numpy as np
import urllib.request as ur

detector = dlib.get_frontal_face_detector()


def get_image_with_landmarks(imageSelfie, imageDataList):
    # rects = None
    # gray = None
    # clone = None
    #
    # try:
    #     # image = cv2.imread(file_path, 1)
    #     # image = Resizer(image, height=240)
    #     # gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
    #     # clone = image.copy()
    #     # rects = detector(gray, 1)
    #
    # except Exception:
    #     return {'error': 'Error while reading the image'}

    # decoded = ur.urlopen('https://awsimages.detik.net.id/visual/2022/06/19/tesla-muskdogecoin-lawsuit_169.jpeg?w=715&q=90')

    # base64_str = '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'

    buffer = io.BytesIO()
    imgdata = base64.b64decode(imageSelfie)
    img = Image.open(io.BytesIO(imgdata))
    new_img = img.resize((400, 400))  # x, y
    new_img.save(buffer, format="jpeg")

    # decoded = ur.urlopen(image)
    image_loaded = face_recognition.load_image_file(buffer)
    imgTest = face_recognition.load_image_file('data_images/sby-1.png')
    # img_b64 = base64.b64encode(buffer.getvalue())
    # print(str(img_b64)[2:-1])


    # daa = img.resize((400, 400))
    gray = cv2.cvtColor(image_loaded, cv2.COLOR_BGR2GRAY)
    rects = detector(gray, 1)

    any_face_was_found = len(rects) > 0
    if any_face_was_found:
        # for (i, rect) in enumerate(rects):
        #     shape = predictor(gray, rect)
        #     shape = face_utils.shape_to_np(shape)
        #
        #     for point in range(1, 68):
        #         coords = shape.tolist()[point]
        #         cv2.circle(clone, (coords[0], coords[1]), 1, (0, 0, 255), thickness=2)

        # imgElon = face_recognition.load_image_file(image_loaded)
        imgElon = cv2.cvtColor(image_loaded, cv2.COLOR_BGR2RGB)
        imgTest = cv2.cvtColor(imgTest, cv2.COLOR_BGR2RGB)

        faceLoc = face_recognition.face_locations(imgElon)[0]
        encodeElon = face_recognition.face_encodings(imgElon)[0]
        cv2.rectangle(imgElon, (faceLoc[3], faceLoc[0]), (faceLoc[1], faceLoc[2]), (255, 0, 255), 2)

        faceLoc2 = face_recognition.face_locations(imgTest)[0]
        encodeTest = face_recognition.face_encodings(imgTest)[0]
        cv2.rectangle(imgTest, (faceLoc2[3], faceLoc2[0]), (faceLoc2[1], faceLoc2[2]), (255, 0, 255), 2)

        results = face_recognition.compare_faces([encodeElon], encodeTest)
        face_distance = face_recognition.face_distance([encodeElon], encodeTest)
        print(results, face_distance)
    else:
        return {'error': 'No face was detected in the image provided'}

    # retval, buffer = cv2.imencode('.jpg', clone)
    # image_as_text = base64.b64encode(buffer)

    # return {'image_with_landmarks': 'data:image/png;base64,{}'.format(quote(image_as_text))}
    return {'confidence': format(face_distance)}

# ekstrak jadi library / jadiin API

# https://youtu.be/sz25xxF_AVE?t=994
